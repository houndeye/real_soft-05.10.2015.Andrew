define(["exports"],function(e){"use strict";var r=require(__dirname+"/../../lib/mongoose"),t=r.Schema,s=(require("util"),require("crypto")),n=new t({username:{type:String,unique:!0,required:!0},hashedPassword:{type:String,required:!0},firstName:String,lastName:String,email:String,phone:String,salt:{type:String,required:!0},created:{type:Date,"default":Date.now}});n.methods.encryptPassword=function(e){return s.createHmac("sha1",this.salt).update(e).digest("hex")},n.virtual("password").set(function(e){this._plainPassword=e,this.salt=Math.random()+"",this.hashedPassword=this.encryptPassword(e)}).get(function(){return this._plainPassword}),n.methods.checkPassword=function(e){return this.encryptPassword(e)===this.hashedPassword},n.statics.authorize=function(e,r){var t=this;return regeneratorRuntime.mark(function s(){var n;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.findOne({username:e});case 2:if(n=s.sent,!n){s.next=10;break}if(!n.checkPassword(r)){s.next=8;break}return s.abrupt("return",n);case 8:return console.log("������ �������"),s.abrupt("return",null);case 10:case"end":return s.stop()}},s,this)})},e.User=r.model("users",n)});