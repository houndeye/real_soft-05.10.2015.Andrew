define(["exports","module","react"],function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}var o=s(a);e.exports=o["default"].createClass({displayName:"map",getInitialState:function(){return{map:null,markers:[]}},getDefaultProps:function(){return{lat:0,lng:0,zoom:4,width:500,height:500,points:[],gmaps_api_key:"",gmaps_sensor:!1}},updateMarkers:function(t){var e=this.state.markers,a=this.state.map;return null===a?!1:(e.forEach(function(t){t.setMap(null)}),this.state.markers=[],t.forEach(function(t){var s=new google.maps.LatLng(t.lat,t.lng);a.setCenter(s);var o=new google.maps.Marker({position:s,map:a,title:t.label});e.push(o)}),void this.setState({markers:e}))},render:function(){var t={width:this.props.width,height:this.props.height};return o["default"].DOM.div({style:t})},componentDidMount:function(){var t=function(){var t={zoom:this.props.zoom,center:new google.maps.LatLng(this.props.lat,this.props.lng),mapTypeId:google.maps.MapTypeId.ROADMAP},e=new google.maps.Map(this.getDOMNode(),t);this.setState({map:e}),this.updateMarkers(this.props.points)}.bind(this);if("undefined"!=typeof google)t();else{if(!window.reactMapCallback){var e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key="+this.props.gmaps_api_key+"&sensor="+this.props.gmaps_sensor+"&callback=reactMapCallback",document.head.appendChild(e),window.reactMapCallbacks=[],window.reactMapCallback=function(){for(;window.reactMapCallbacks.length>0;)window.reactMapCallbacks.shift()()}}window.reactMapCallbacks.push(t)}},componentWillReceiveProps:function(t){t.points&&(this.setState({markers:[]}),this.updateMarkers(t.points))}})});